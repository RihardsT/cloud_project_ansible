---
- hosts: all
  become: yes
  become_user: root
  become_method: sudo
  vars:
    repo_path: /srv/repo
  tasks:
    # Set up IP change notification to telegram
    - name: Copy IP check script, that notifies to telegram
      copy:
        src: ../Secrets/ip_change_telegram.sh
        dest: /root/ip_change_telegram.sh
        owner: root
        group: root
        mode: 0700
    - name: set up cronjob to notify of IP change
      cron:
        name: "ip_change_notify_telegram"
        minute: "*/30"
        user: root
        # cron_file: /etc/cron.hourly/ip_change_notify_telegram
        job: "/bin/bash /root/ip_change_telegram.sh"